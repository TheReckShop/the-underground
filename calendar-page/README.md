  With gratitude to Scott Andrew LePera, the host of jszen.blogspot.com, for his contribution to the structure of this code.
